<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sampling Aware Ancestral State Inference • saasi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sampling Aware Ancestral State Inference">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">saasi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bib_example.html">Example of how to use the bib</a>
    </li>
    <li>
      <a href="../articles/saasi-tutorial.html">Sampling Aware Ancestral State Inference</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sampling Aware Ancestral State Inference</h1>
                        <h4 data-toc-skip class="author">Yexuan
Song</h4>
            
            <h4 data-toc-skip class="date">2026-02-06</h4>
      

      <div class="hidden name"><code>saasi-tutorial.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">saasi</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.zoology.ubc.ca/prog/diversitree/" class="external-link">diversitree</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ape</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/contribution-tree-data/" class="external-link">tidytree</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; tidytree v0.4.7 Learn more at https://yulab-smu.top/contribution-tree-data/</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Please cite:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LG Wang, TTY Lam, S Xu, Z Dai, L Zhou, T Feng, P Guo, CW Dunn, BR</span></span>
<span><span class="co">#&gt; Jones, T Bradley, H Zhu, Y Guan, Y Jiang, G Yu. treeio: an R package</span></span>
<span><span class="co">#&gt; for phylogenetic tree input and output with richly annotated and</span></span>
<span><span class="co">#&gt; associated data. Molecular Biology and Evolution. 2020, 37(2):599-603.</span></span>
<span><span class="co">#&gt; doi: 10.1093/molbev/msz240</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidytree'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:ape':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     drop.tip, keep.tip</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: maps</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<!-- badges: start -->
<!-- badges: end -->
<p>This vignette demonstrates how to use the <code>saasi</code> package
for ancestral state reconstruction.</p>
<p>Saasi (Sampling-Aware Ancestral State Inference) is an ancestral
state reconstruction method that accounts for variation in sampling
rates among locations or traits. Unlike traditional methods that assume
uniform sampling, saasi explicitly models heterogeneous sampling rates,
leading to more accurate ancestral state estimates in unevenly sampled
phylogenies.</p>
<p>NOTE: THIS DOCUMENT IS SUBJECT TO CHANGE (FUNCTION NAMES, ARGUMENTS
ETC).</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of saasi from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"MAGPIE-SFU/saasi"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>saasi</code> function requires three main inputs:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>A phylogenetic tree</strong> (class <code>phylo</code>)
that is:</p>
<ul>
<li>Rooted and binary</li>
<li>Has branch lengths in units of time (all positive)</li>
<li>Contains tip states (<code>tree$tip.state</code>) with no missing
values</li>
</ul>
<p>Use <code><a href="../reference/check_tree_compatibility.html">check_tree_compatibility()</a></code> to verify compatibility
and <code><a href="../reference/prepare_tree_for_saasi.html">prepare_tree_for_saasi()</a></code> to prepare your tree.</p>
</li>
<li>
<p><strong>Birth-death-sampling parameters</strong> (class
<code>data.frame</code>):</p>
<ul>
<li>Speciation rate</li>
<li>Extinction/removal rate</li>
<li>Sampling rate</li>
</ul>
<p>Use <code><a href="../reference/estimate_bds_parameters.html">estimate_bds_parameters()</a></code> to estimate speciation and
sampling rates. Users should specify the extinction rate based on domain
knowledge.</p>
</li>
<li>
<p><strong>Transition rate matrix Q</strong> (class
<code>matrix</code>):</p>
<ul>
<li>Rates of transition between states</li>
</ul>
<p>Use <code><a href="../reference/estimate_transition_rates.html">estimate_transition_rates()</a></code> to estimate transition
rates.</p>
</li>
</ol>
<p>The output is a data frame containing the probability of each state
for each internal node of the phylogenetic tree.</p>
<div class="section level3">
<h3 id="example-ebola-2013-2016-west-african-ebola-epidemic">Example: Ebola 2013-2016 West African Ebola Epidemic<a class="anchor" aria-label="anchor" href="#example-ebola-2013-2016-west-african-ebola-epidemic"></a>
</h3>
<div class="section level4">
<h4 id="read-tree-and-load-metadata">Read tree and load metadata<a class="anchor" aria-label="anchor" href="#read-tree-and-load-metadata"></a>
</h4>
<p>For this example, we use data from Nextstrain: <a href="https://nextstrain.org/ebola/ebov-2013?c=country" class="external-link uri">https://nextstrain.org/ebola/ebov-2013?c=country</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"nextstrain_ebola_ebov-2013_timetree.nwk"</span>, package <span class="op">=</span> <span class="st">"saasi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"nextstrain_ebola_ebov-2013_metadata.tsv"</span>, package <span class="op">=</span> <span class="st">"saasi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">1493</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (7): strain, country, division, author, author__url, accession, accessi...</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">date</span> (1): date</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>First, create a data frame containing strains and states. The first
column of the data frame should match <code>tree$tip.label</code>, and
the second column should contain the state of interest. Users can skip
this step if <code>tree$tip.state</code> already exists.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tip_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  tip_label <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">strain</span>,</span>
<span>  state <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">country</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="modify-the-tree-to-be-compatible-with-saasi">Modify the tree to be compatible with saasi<a class="anchor" aria-label="anchor" href="#modify-the-tree-to-be-compatible-with-saasi"></a>
</h4>
<p>Users can apply the function <code><a href="../reference/prepare_tree_for_saasi.html">prepare_tree_for_saasi()</a></code> to
make the tree compatible with saasi. To check if the tree is compatible,
use the function <code><a href="../reference/check_tree_compatibility.html">check_tree_compatibility()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_tree_for_saasi.html">prepare_tree_for_saasi</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">tip_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="estimating-transition-rates">Estimating transition rates<a class="anchor" aria-label="anchor" href="#estimating-transition-rates"></a>
</h4>
<p>Users can estimate the transition rate matrix Q using the function
<code><a href="../reference/estimate_transition_rates.html">estimate_transition_rates()</a></code>. Users can specify the model
for the transition rate matrix: 1. Equal rate <code>ER</code>, 2.
Symmetric rate <code>SYM</code>, 3. All rates different
<code>ARD</code>, and Custom <code>custom_q</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_transition_rates.html">estimate_transition_rates</a></span><span class="op">(</span><span class="va">ebola_tree</span>, method <span class="op">=</span> <span class="st">'simmap'</span>, matrix_structure <span class="op">=</span> <span class="st">'SYM'</span><span class="op">)</span></span>
<span><span class="co">#&gt; make.simmap is sampling character histories conditioned on</span></span>
<span><span class="co">#&gt; the transition matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Q =</span></span>
<span><span class="co">#&gt;                  Guinea    Liberia Sierra Leone</span></span>
<span><span class="co">#&gt; Guinea       -0.4718225  0.2604149    0.2114077</span></span>
<span><span class="co">#&gt; Liberia       0.2604149 -0.3697299    0.1093150</span></span>
<span><span class="co">#&gt; Sierra Leone  0.2114077  0.1093150   -0.3207227</span></span>
<span><span class="co">#&gt; (estimated using likelihood);</span></span>
<span><span class="co">#&gt; and (mean) root node prior probabilities</span></span>
<span><span class="co">#&gt; pi =</span></span>
<span><span class="co">#&gt;       Guinea      Liberia Sierra Leone </span></span>
<span><span class="co">#&gt;    0.3333333    0.3333333    0.3333333</span></span>
<span><span class="co">#&gt; Done.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="estimating-speciation-and-sampling-rates">Estimating speciation and sampling rates<a class="anchor" aria-label="anchor" href="#estimating-speciation-and-sampling-rates"></a>
</h4>
<p>Users can estimate speciation and sampling rates using the function
<code><a href="../reference/estimate_bds_parameters.html">estimate_bds_parameters()</a></code>. Users should have some knowledge
about the expected removal rate (1/mu) for the disease of interest, as
saasi requires the extinction rate mu to be known. To obtain better
estimates for the overall speciation and sampling rates, users should
have knowledge about the maximum and minimum R0, as well as the upper
and lower bounds for the total removal rate (1/(mu+psi)).</p>
<p>For Ebola, we assume the total infectious period (1/(mu+psi)) is
between 20 and 40 days. Converting to years, the total removal rate (mu
+ psi) is between 9.125 (365/40) and 18.25 (365/20). If we assume mu =
5, this gives us bounds for the overall sampling rate psi between 4.125
and 13.25. In this example, we assume R0 is between 1.5 and 3.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_bds_parameters.html">estimate_bds_parameters</a></span><span class="op">(</span></span>
<span>    <span class="va">ebola_tree</span>,</span>
<span>    mu <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    r0_max <span class="op">=</span> <span class="fl">3</span>, </span>
<span>    r0_min <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    psi_max <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    infectious_period_min <span class="op">=</span> <span class="fl">20</span><span class="op">/</span><span class="fl">365</span>, <span class="co"># convert days to years</span></span>
<span>    infectious_period_max <span class="op">=</span> <span class="fl">40</span><span class="op">/</span><span class="fl">365</span>, <span class="co"># convert days to years</span></span>
<span>    n_starts <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-saasi-analysis">Run saasi analysis<a class="anchor" aria-label="anchor" href="#run-saasi-analysis"></a>
</h4>
<p>Users can run the saasi analysis by specifying the following
parameters:</p>
<ul>
<li>
<strong>phy</strong> - A <code>phylo</code> object containing the
phylogenetic tree</li>
<li>
<strong>q_matrix</strong> - An n × n transition rate matrix (class
<code>matrix</code>), where n is the number of states</li>
<li>
<strong>lambda</strong> - Speciation rate(s) for each state. If
<code>length(lambda) = 1</code>, all states are assumed to have the same
speciation rate; otherwise, provide a vector of length n</li>
<li>
<strong>mu</strong> - Extinction rate(s) for each state. If
<code>length(mu) = 1</code>, all states are assumed to have the same
extinction rate; otherwise, provide a vector of length n</li>
<li>
<strong>psi</strong> - Sampling rate(s) for each state. If
<code>length(psi) = 1</code>, all states are assumed to have the same
sampling rate; otherwise, provide a vector of length n</li>
<li>
<strong>prior</strong> - Prior probabilities for the root node. If
<code>NULL</code> (default), uses equal probabilities across all
states</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">saasi_ebola</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saasi.html">saasi</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">ebola_tree</span>,            <span class="co"># phylogenetic tree</span></span>
<span>                     q_matrix <span class="op">=</span> <span class="va">Q</span>,                <span class="co"># transition rate matrix</span></span>
<span>                     lambda <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">lambda</span>,       <span class="co"># speciation rate</span></span>
<span>                     mu <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">mu</span>,               <span class="co"># extinction rate</span></span>
<span>                     psi <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">psi</span>,             <span class="co"># sampling rate</span></span>
<span>                     prior <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>                <span class="co"># root prior (equal probabilities)</span></span>
<span><span class="co">#&gt; Tree is compatible with SAASI</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-and-save-the-result">Plot and save the result<a class="anchor" aria-label="anchor" href="#plot-and-save-the-result"></a>
</h4>
<p>Users can use the built-in function <code><a href="../reference/plot_saasi.html">plot_saasi()</a></code> to
visualize results. Set <code>save_file = NULL</code> to display without
saving.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_saasi.html">plot_saasi</a></span><span class="op">(</span><span class="va">ebola_tree</span>, <span class="va">saasi_ebola</span>, save_file <span class="op">=</span> <span class="st">"ebola_equal_psi.png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-saasi-with-a-different-set-of-parameters">Run saasi with a different set of parameters<a class="anchor" aria-label="anchor" href="#run-saasi-with-a-different-set-of-parameters"></a>
</h4>
<p>Users can specify different parameters for different locations. For
example, if we assume that Liberia samples at half the rate of other
countries:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pars2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_params_template.html">create_params_template</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">lambda</span>, mu <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">mu</span>, psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rates</span><span class="op">$</span><span class="va">psi</span>, <span class="va">rates</span><span class="op">$</span><span class="va">psi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">rates</span><span class="op">$</span><span class="va">psi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">saasi_ebola2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/saasi.html">saasi</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">ebola_tree</span>,                           <span class="co"># phylogenetic tree</span></span>
<span>                     q_matrix <span class="op">=</span> <span class="va">Q</span>,                                <span class="co"># transition rate matrix</span></span>
<span>                     lambda <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">lambda</span>,                       <span class="co"># speciation rate</span></span>
<span>                     mu <span class="op">=</span> <span class="va">rates</span><span class="op">$</span><span class="va">mu</span>,                               <span class="co"># extinction rate</span></span>
<span>                     psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rates</span><span class="op">$</span><span class="va">psi</span>, <span class="va">rates</span><span class="op">$</span><span class="va">psi</span><span class="op">/</span><span class="fl">2</span>, <span class="va">rates</span><span class="op">$</span><span class="va">psi</span><span class="op">)</span>,  <span class="co"># sampling rate</span></span>
<span>                     prior <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Tree is compatible with SAASI</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_saasi.html">plot_saasi</a></span><span class="op">(</span><span class="va">ebola_tree</span>, <span class="va">saasi_ebola2</span>, save_file <span class="op">=</span> <span class="st">"ebola_unequal_psi.png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="interpreting-results">Interpreting results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h4>
<p>The <code><a href="../reference/saasi.html">saasi()</a></code> function returns a data frame with
probability distributions over states for each internal node. Higher
probabilities indicate greater confidence in that ancestral state. When
comparing equal versus unequal sampling rates, you may notice
differences in ancestral state probabilities, particularly for nodes
ancestral to under-sampled locations like Liberia.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ivan Gill, Yexuan Song.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
