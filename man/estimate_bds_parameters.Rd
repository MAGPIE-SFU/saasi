% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bds_estimation_new.R
\name{estimate_bds_parameters}
\alias{estimate_bds_parameters}
\title{Estimate birth-death-sampling parameters}
\usage{
estimate_bds_parameters(
  phy,
  mu,
  trim = c(0.1, 0.5),
  n_starts = 100,
  force_two_step = FALSE,
  psi_max = 7,
  r0_min = 1,
  r0_max = 5,
  infectious_period_min = NULL,
  infectious_period_max = NULL
)
}
\arguments{
\item{phy}{A phylo object with branch lengths. Must be rooted and binary.}

\item{mu}{Fixed extinction rate (required)}

\item{trim}{Numeric vector of length 2 specifying quantiles for trimming
node times in LTT. Default c(0.10, 0.50).}

\item{n_starts}{Number of starting points for multi-start optimization. Default 100.}

\item{force_two_step}{Logical. If TRUE, uses two-step estimates even if they
violate constraints. Default FALSE.}

\item{psi_max}{Maximum sampling rate per unit time. Default 7.}

\item{r0_min}{Minimum basic reproductive number (R0 = lambda/(mu+psi)). Default 1.}

\item{r0_max}{Maximum basic reproductive number. Default 5.}

\item{infectious_period_min}{Minimum infectious period (1/(mu+psi)). Default NULL.}

\item{infectious_period_max}{Maximum infectious period (1/(mu+psi)). Default NULL.}
}
\value{
An object of class "bds_estimate" containing:
\itemize{
\item lambda: Estimated speciation rate
\item psi: Estimated sampling rate
\item mu: Fixed death rate (input)
\item r0: Estimated basic reproductive number (lambda/(mu+psi))
\item infectious_period: Estimated infectious period
\item method: Estimation method used ("two_step_constrained", "mle_constrained", or "two_step_forced")
\item a: Net diversification rate (lambda - mu - psi) from LTT
\item b: Ratio lambda/(mu + psi) from MLE
\item n_tips: Number of tips in the tree
\item n_nodes: Number of internal nodes
\item mle_fit: Full MLE fit object from step 1
\item constraints: List of constraint parameters used
}
}
\description{
Estimates lambda (speciation rate) and psi (sampling rate) for
a phylogenetic tree. The function enforces
epidemiological constraints including R0 bounds and infectious period limits.
}
\details{
The estimation proceeds in two steps:
\enumerate{
\item Maximum likelihood estimation with fixed mu to get estimates for (lambda/(mu+psi))
\item Using lineage-through-time plot to estimate net diversification rate (lambda - mu - psi)
}

With mu known, we can estimate lambda and psi using the above estimates.

If the two-step method produces estimates that violate constraints or is
numerically unstable, the function falls back to the MLE estimates from step 1.
}
