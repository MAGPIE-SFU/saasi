% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saasi.R
\name{saasi}
\alias{saasi}
\title{Sampling-Aware Ancestral State Inference}
\usage{
saasi(phy, Q, pars, sensitivity_test = FALSE)
}
\arguments{
\item{phy}{A \code{phylo} object containing the phylogenetic tree. The tree must be
rooted, binary, and contain \code{tip.state}.}

\item{q_matrix}{A numeric transition rate matrix (n Ã— n) where n is the number
of states. Row and column names represent states. Off-diagonal
elements are transition rates; diagonal elements are set such that rows sum to zero.}

\item{lambda}{Speciation rate(s) for each state. Can be a single numeric value
(same rate for all states) or a vector of length n (different rates per state).}

\item{mu}{Extinction rate(s) for each state. Can be a single numeric value
(same rate for all states) or a vector of length n (different rates per state).}

\item{psi}{Sampling rate(s) for each state. Can be a single numeric value
(same rate for all states) or a vector of length n (different rates per state).}

\item{prior}{Prior probabilities for each state at the root node. If \code{NULL}
(default), equal probabilities are assigned to all states. Otherwise, provide
a vector of length n that sums to 1.}
}
\value{
A data frame with state probabilities for each internal node in \code{phy}.
}
\description{
Reconstructs ancestral states for internal nodes of a phylogenetic tree while
accounting for heterogeneous sampling rates across states or locations.
}
\examples{
\dontrun{
# Run saasi with equal sampling rates
result <- saasi(phy = tree, 
                q_matrix = Q,
                lambda = rates$lambda,
                mu = rates$mu,
                psi = rates$psi,
                prior = NULL)

# Run saasi with different sampling rates per state
result2 <- saasi(phy = tree,
                 q_matrix = Q,
                 lambda = rates$lambda,
                 mu = rates$mu,
                 psi = c(rates$psi, rates$psi/2, rates$psi),
                 prior = NULL)
}

}
